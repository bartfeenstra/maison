#!/usr/bin/env bash

cd `dirname "$0"`/..

# Aggregate test exit codes.
exit_code=0
trap '(( exit_code |= $? ))' ERR

./bin/build
./bin/run

# Connect to Alfred.
#curl http://localhost:8081/about/json/schema
## Connect to OLA.
#curl http://localhost:9090
# Connect to the Alfred client.
curl http://localhost:8082

./bin/stop

# Stop aggregating test exit codes.
trap - ERR

if [ $exit_code -eq 0 ]
then
    echo "SUCCESS: ALL TESTS PASSED."
else
    echo "ERROR: SOME TESTS FAILED."
fi
exit $exit_code
