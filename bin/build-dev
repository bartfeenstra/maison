#!/usr/bin/env bash

set -Eeuo pipefail

cd "$(dirname "$0")/.."

./bin/build

# Install Vagrant plugins.
vagrant plugin install vagrant-env

# Set a default Vagrant VM IP.
if [ -f ./.env ]; then
    sed -Ei 's/^MAISON_LOCAL_IP=.*$/MAISON_LOCAL_IP=192.168.152.9/' .env
fi

# Disable HTTPS.
sed -Ei 's/^MAISON_WEB_PROTOCOL=.*$/MAISON_WEB_PROTOCOL=http/' ./.env

# Set email addresses.
sed -Ei 's/^(MAISON_.+)_EMAIL=$/\1_EMAIL=\1@example.com/' ./.env
